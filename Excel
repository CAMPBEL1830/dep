import pandas as pd

# Charger le fichier Excel
file_path = 'votre_fichier.xlsx'
df = pd.read_excel(file_path)

# Regrouper les données et compter les IDs uniques
result = df.groupby(['Groupe', 'Segment'])['ID'].nunique().reset_index()

# Renommer la colonne de comptage
result.rename(columns={'ID': 'Nombre d\'ID uniques'}, inplace=True)

# Enregistrer les résultats dans un nouveau fichier Excel
result.to_excel('grouped_segments.xlsx', index=False)

print("Les résultats ont été enregistrés dans 'grouped_segments.xlsx'.")
