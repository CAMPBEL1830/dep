import pandas as pd

# Charger le fichier Excel
file_path = 'votre_fichier.xlsx'
df = pd.read_excel(file_path)

# Associer chaque ID à son année d'octroi et groupe
id_info = df[['ID', 'Année_octroi', 'Groupe']].drop_duplicates()

# Enregistrer les résultats dans un nouveau fichier Excel
id_info.to_excel('id_with_year_and_group.xlsx', index=False)

print("Les résultats ont été enregistrés dans 'id_with_year_and_group.xlsx'.")



code 2


import pandas as pd

# Charger le fichier Excel
file_path = 'votre_fichier.xlsx'
df = pd.read_excel(file_path)

# Associer chaque ID à son année d'octroi et groupe
id_year_group = df[['ID', 'Année_octroi', 'Groupe']].drop_duplicates()

# Compter le nombre d'ID uniques par année et groupe
result = id_year_group.groupby(['Année_octroi', 'Groupe'])['ID'].nunique().reset_index()

# Renommer la colonne de comptage
result.rename(columns={'ID': 'Nombre_ID_uniques'}, inplace=True)

# Enregistrer les résultats dans un nouveau fichier Excel
result.to_excel('id_count_by_year_and_group.xlsx', index=False)

print("Les résultats ont été enregistrés dans 'id_count_by_year_and_group.xlsx'.")
